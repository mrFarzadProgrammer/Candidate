<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø±Ù‚Ø§Ø¨ØªÛŒ - Ù¾Ù†Ù„ Ù†Ù…Ø§ÛŒÙ†Ø¯Ù‡</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/modern-admin.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='fonts/fontawesome/all.min.css') }}">
    <style>
        .benchmark-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(102, 126, 234, 0.3);
        }
        
        .benchmark-card h2 {
            font-size: 28px;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .benchmark-card p {
            opacity: 0.9;
            font-size: 15px;
        }
        
        .stat-comparison {
            background: white;
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }
        
        .stat-comparison h3 {
            font-size: 16px;
            color: #64748b;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        .comparison-bars {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .comparison-item {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .comparison-label {
            min-width: 120px;
            font-size: 14px;
            color: #475569;
            font-weight: 500;
        }
        
        .comparison-bar-container {
            flex: 1;
            height: 40px;
            background: #f1f5f9;
            border-radius: 10px;
            position: relative;
            overflow: hidden;
        }
        
        .comparison-bar {
            height: 100%;
            border-radius: 10px;
            display: flex;
            align-items: center;
            padding: 0 15px;
            font-weight: 600;
            color: white;
            transition: width 1s ease;
        }
        
        .bar-mine {
            background: linear-gradient(90deg, #f59e0b, #ef4444);
        }
        
        .bar-average {
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
        }
        
        .bar-top {
            background: linear-gradient(90deg, #10b981, #059669);
        }
        
        .percentile-display {
            background: linear-gradient(135deg, #ec4899, #8b5cf6);
            color: white;
            border-radius: 16px;
            padding: 30px;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .percentile-number {
            font-size: 64px;
            font-weight: 700;
            line-height: 1;
            margin-bottom: 10px;
        }
        
        .percentile-label {
            font-size: 18px;
            opacity: 0.9;
        }
        
        .rank-badge {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: white;
            border-radius: 50%;
            width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: 700;
            margin: 0 auto 15px;
            box-shadow: 0 8px 24px rgba(245, 158, 11, 0.4);
        }
        
        .upgrade-card {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border-radius: 16px;
            padding: 30px;
            margin-top: 30px;
        }
        
        .upgrade-card h3 {
            font-size: 24px;
            margin-bottom: 15px;
            color: white;
        }
        
        .upgrade-features {
            list-style: none;
            padding: 0;
            margin: 20px 0;
        }
        
        .upgrade-features li {
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .upgrade-features li:last-child {
            border-bottom: none;
        }
        
        .upgrade-features i {
            color: #86efac;
        }
        
        .btn-upgrade {
            background: white;
            color: #059669;
            padding: 15px 40px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 16px;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-block;
            text-decoration: none;
        }
        
        .btn-upgrade:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.2);
        }
        
        .progress-ring {
            width: 150px;
            height: 150px;
            margin: 0 auto 20px;
        }
        
        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .insight-card {
            background: white;
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }
        
        .insight-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 15px;
        }
        
        .insight-icon.blue { background: #dbeafe; color: #2563eb; }
        .insight-icon.green { background: #d1fae5; color: #059669; }
        .insight-icon.purple { background: #ede9fe; color: #7c3aed; }
        .insight-icon.orange { background: #fed7aa; color: #ea580c; }
        
        .insight-card h4 {
            font-size: 16px;
            margin-bottom: 10px;
            color: #1e293b;
        }
        
        .insight-card p {
            font-size: 14px;
            color: #64748b;
            line-height: 1.6;
        }
        
        @media (max-width: 768px) {
            .comparison-item {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .comparison-label {
                min-width: auto;
            }
            
            .comparison-bar-container {
                width: 100%;
            }
            
            .percentile-number {
                font-size: 48px;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-wrapper">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-user-tie" style="font-size: 40px;"></i>
                </div>
                <h2>Ù¾Ù†Ù„ Ù†Ù…Ø§ÛŒÙ†Ø¯Ù‡</h2>
                <p>{{ candidate.full_name }}</p>
            </div>
            
            <nav class="sidebar-menu">
                <a href="{{ url_for('dashboard') }}" class="menu-item">
                    <i class="fas fa-home"></i>
                    <span>Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯</span>
                </a>
                <a href="{{ url_for('benchmark') }}" class="menu-item active">
                    <i class="fas fa-chart-line"></i>
                    <span>Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø±Ù‚Ø§Ø¨ØªÛŒ</span>
                </a>
                <a href="{{ url_for('view_plans') }}" class="menu-item">
                    <i class="fas fa-tags"></i>
                    <span>Ù¾Ù„Ù†â€ŒÙ‡Ø§ÛŒ Ø§Ø´ØªØ±Ø§Ú©</span>
                </a>
                <a href="{{ url_for('analytics') }}" class="menu-item">
                    <i class="fas fa-chart-bar"></i>
                    <span>Ø¢Ù…Ø§Ø± Ùˆ ØªØ­Ù„ÛŒÙ„</span>
                </a>
                <a href="{{ url_for('contributions') }}" class="menu-item">
                    <i class="fas fa-users"></i>
                    <span>Ù…Ø´Ø§Ø±Ú©Øª Ø´Ù‡Ø±ÙˆÙ†Ø¯ÛŒ</span>
                </a>
                <a href="{{ url_for('logout') }}" class="menu-item" style="margin-top: auto;">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Ø®Ø±ÙˆØ¬</span>
                </a>
            </nav>
        </aside>
        
        <!-- Main Content -->
        <div class="main-content">
            <!-- Topbar -->
            <div class="topbar">
                <div class="topbar-left">
                    <button class="sidebar-toggle" id="sidebarToggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1>ğŸ“Š Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø±Ù‚Ø§Ø¨ØªÛŒ</h1>
                </div>
                <div class="topbar-right">
                    <a href="{{ url_for('benchmark_refresh') }}" class="btn btn-primary">
                        <i class="fas fa-sync-alt"></i> Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ
                    </a>
                </div>
            </div>
            
            <!-- Content -->
            <div class="content-area">
                
                <!-- Hero Card -->
                <div class="benchmark-card">
                    <h2>ğŸ¯ Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø´Ù…Ø§ Ø¯Ø± Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø¨Ø§ Ø³Ø§ÛŒØ± Ù†Ø§Ù…Ø²Ø¯Ù‡Ø§</h2>
                    <p>Ø¨Ø¨ÛŒÙ†ÛŒØ¯ Ú©Ù‡ Ø¯Ø± Ú©Ø¬Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø± Ù‚Ø±Ø§Ø± Ø¯Ø§Ø±ÛŒØ¯ Ùˆ Ú†Ú¯ÙˆÙ†Ù‡ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¨Ù‡ØªØ± Ø´ÙˆÛŒØ¯</p>
                </div>
                
                <div class="row">
                    <!-- Rank & Percentile -->
                    <div class="col-md-6">
                        <div class="stat-comparison">
                            <h3>ğŸ† Ø±ØªØ¨Ù‡ Ø´Ù…Ø§</h3>
                            {% if ranking %}
                            <div class="rank-badge">
                                #{{ ranking.overall_rank }}
                            </div>
                            <div class="text-center">
                                <p style="font-size: 16px; color: #64748b;">
                                    Ø§Ø² Ù…Ø¬Ù…ÙˆØ¹ <strong>{{ comparison.benchmark.sample_size }}</strong> Ù†Ø§Ù…Ø²Ø¯ ÙØ¹Ø§Ù„
                                </p>
                            </div>
                            {% else %}
                            <p class="text-center" style="color: #94a3b8;">Ø¯Ø± Ø­Ø§Ù„ Ù…Ø­Ø§Ø³Ø¨Ù‡...</p>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="percentile-display">
                            {% if comparison %}
                            <div class="percentile-number">
                                {{ comparison.comparison.better_than_percent|round|int }}%
                            </div>
                            <div class="percentile-label">
                                Ø¨Ù‡ØªØ± Ø§Ø² Ø³Ø§ÛŒØ± Ù†Ø§Ù…Ø²Ø¯Ù‡Ø§
                            </div>
                            {% else %}
                            <div class="percentile-number">-</div>
                            <div class="percentile-label">Ø¯Ø± Ø­Ø§Ù„ Ù…Ø­Ø§Ø³Ø¨Ù‡</div>
                            {% endif %}
                        </div>
                    </div>
                </div>
                
                <!-- Comparison Chart -->
                {% if comparison %}
                <div class="stat-comparison">
                    <h3>ğŸ“Š Ù…Ù‚Ø§ÛŒØ³Ù‡ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØªÛŒ</h3>
                    <div class="comparison-bars">
                        <div class="comparison-item">
                            <div class="comparison-label">Ø´Ù…Ø§</div>
                            <div class="comparison-bar-container">
                                <div class="comparison-bar bar-mine" 
                                     style="width: {{ (comparison.my_stats.messages / comparison.benchmark.top_10_messages * 100) if comparison.benchmark.top_10_messages > 0 else 0 }}%">
                                    {{ comparison.my_stats.messages }} Ù¾ÛŒØ§Ù…
                                </div>
                            </div>
                        </div>
                        
                        <div class="comparison-item">
                            <div class="comparison-label">Ù…ÛŒØ§Ù†Ú¯ÛŒÙ†</div>
                            <div class="comparison-bar-container">
                                <div class="comparison-bar bar-average" 
                                     style="width: {{ (comparison.benchmark.avg_messages / comparison.benchmark.top_10_messages * 100) if comparison.benchmark.top_10_messages > 0 else 0 }}%">
                                    {{ comparison.benchmark.avg_messages|round|int }} Ù¾ÛŒØ§Ù…
                                </div>
                            </div>
                        </div>
                        
                        <div class="comparison-item">
                            <div class="comparison-label">10% Ø¨Ø±ØªØ±</div>
                            <div class="comparison-bar-container">
                                <div class="comparison-bar bar-top" style="width: 100%">
                                    {{ comparison.benchmark.top_10_messages }} Ù¾ÛŒØ§Ù…
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    {% if comparison.comparison.vs_average != 0 %}
                    <div style="margin-top: 20px; padding: 15px; background: #f8fafc; border-radius: 12px;">
                        {% if comparison.comparison.vs_average > 0 %}
                        <p style="color: #059669; font-weight: 600;">
                            ğŸ‰ Ø¹Ø§Ù„ÛŒ! Ø´Ù…Ø§ <strong>{{ comparison.comparison.vs_average|round|int }}%</strong> Ø¨Ù‡ØªØ± Ø§Ø² Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ù‡Ø³ØªÛŒØ¯!
                        </p>
                        {% else %}
                        <p style="color: #dc2626; font-weight: 600;">
                            âš ï¸ Ø´Ù…Ø§ <strong>{{ (comparison.comparison.vs_average * -1)|round|int }}%</strong> Ù¾Ø§ÛŒÛŒÙ†â€ŒØªØ± Ø§Ø² Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ù‡Ø³ØªÛŒØ¯
                        </p>
                        {% endif %}
                    </div>
                    {% endif %}
                </div>
                {% endif %}
                
                <!-- Insights -->
                <div class="insights-grid">
                    <div class="insight-card">
                        <div class="insight-icon blue">
                            <i class="fas fa-users"></i>
                        </div>
                        <h4>Ú©Ø§Ø±Ø¨Ø±Ø§Ù† ÙØ¹Ø§Ù„</h4>
                        <p>
                            Ø´Ù…Ø§: <strong>{{ comparison.my_stats.users if comparison else 0 }}</strong> Ú©Ø§Ø±Ø¨Ø±<br>
                            Ù…ÛŒØ§Ù†Ú¯ÛŒÙ†: <strong>{{ comparison.benchmark.avg_users|round|int if comparison else 0 }}</strong> Ú©Ø§Ø±Ø¨Ø±
                        </p>
                    </div>
                    
                    <div class="insight-card">
                        <div class="insight-icon green">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <h4>Ù¾ØªØ§Ù†Ø³ÛŒÙ„ Ø±Ø´Ø¯</h4>
                        <p>
                            Ø¨Ø§ Ø§Ø±ØªÙ‚Ø§ Ù¾Ù„Ù†ØŒ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ ØªØ§ <strong>{{ potential_growth }}</strong> Ù¾ÛŒØ§Ù… Ø¨ÛŒØ´ØªØ± Ø¯Ø±ÛŒØ§ÙØª Ú©Ù†ÛŒØ¯
                        </p>
                    </div>
                    
                    <div class="insight-card">
                        <div class="insight-icon purple">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <h4>Ù¾Ù„Ù† ÙØ¹Ù„ÛŒ</h4>
                        <p>
                            {% if current_plan %}
                            <strong>{{ current_plan.name }}</strong><br>
                            {{ current_plan.price|number_format }} ØªÙˆÙ…Ø§Ù†/Ù…Ø§Ù‡
                            {% else %}
                            <strong>ØªØ±ÛŒØ§Ù„ Ø±Ø§ÛŒÚ¯Ø§Ù†</strong><br>
                            Ù…Ø­Ø¯ÙˆØ¯ Ø¨Ù‡ 100 Ú©Ø§Ø±Ø¨Ø±
                            {% endif %}
                        </p>
                    </div>
                    
                    <div class="insight-card">
                        <div class="insight-icon orange">
                            <i class="fas fa-bullseye"></i>
                        </div>
                        <h4>Ù‡Ø¯Ù Ø¨Ø¹Ø¯ÛŒ</h4>
                        <p>
                            Ø¨Ø±Ø§ÛŒ ÙˆØ±ÙˆØ¯ Ø¨Ù‡ 10% Ø¨Ø±ØªØ±ØŒ Ø¨Ù‡ <strong>{{ comparison.benchmark.top_10_messages - comparison.my_stats.messages if comparison else 0 }}</strong> Ù¾ÛŒØ§Ù… Ø¯ÛŒÚ¯Ø± Ù†ÛŒØ§Ø² Ø¯Ø§Ø±ÛŒØ¯
                        </p>
                    </div>
                </div>
                
                <!-- Upgrade Suggestion -->
                {% if not current_plan or current_plan.code == 'trial' %}
                <div class="upgrade-card">
                    <h3>ğŸš€ Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ§ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ø±Ø´Ø¯ Ø¨ÛŒØ´ØªØ±ØŸ</h3>
                    <p style="font-size: 16px; opacity: 0.9;">
                        Ù†Ø§Ù…Ø²Ø¯Ù‡Ø§ÛŒÛŒ Ú©Ù‡ Ù¾Ù„Ù† Ù¾ÙˆÙ„ÛŒ Ø¯Ø§Ø±Ù†Ø¯ØŒ Ø¨Ù‡ Ø·ÙˆØ± Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† <strong>5 Ø¨Ø±Ø§Ø¨Ø±</strong> Ø¨ÛŒØ´ØªØ± Ù¾ÛŒØ§Ù… Ø¯Ø±ÛŒØ§ÙØª Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯!
                    </p>
                    
                    <ul class="upgrade-features">
                        <li>
                            <i class="fas fa-check-circle"></i>
                            Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ù†Ø§Ù…Ø­Ø¯ÙˆØ¯
                        </li>
                        <li>
                            <i class="fas fa-check-circle"></i>
                            Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ø§Ù†Ø¨ÙˆÙ‡ ØªØ§ 10ØŒ000 Ù†ÙØ±
                        </li>
                        <li>
                            <i class="fas fa-check-circle"></i>
                            Ø¢Ù…Ø§Ø± Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ùˆ ØªØ­Ù„ÛŒÙ„ Ø±ÙØªØ§Ø±
                        </li>
                        <li>
                            <i class="fas fa-check-circle"></i>
                            Ø³ÛŒØ³ØªÙ… Ù…Ø´Ø§Ø±Ú©Øª Ø´Ù‡Ø±ÙˆÙ†Ø¯ÛŒ Ú©Ø§Ù…Ù„
                        </li>
                        <li>
                            <i class="fas fa-check-circle"></i>
                            Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø®ØªØµØ§ØµÛŒ
                        </li>
                    </ul>
                    
                    <div style="margin-top: 25px;">
                        <a href="{{ url_for('view_plans') }}" class="btn-upgrade">
                            Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù¾Ù„Ù†â€ŒÙ‡Ø§ Ùˆ Ø§Ø±ØªÙ‚Ø§
                        </a>
                    </div>
                </div>
                {% endif %}
                
            </div>
        </div>
    </div>
    
    <script>
        // Sidebar Toggle
        document.getElementById('sidebarToggle')?.addEventListener('click', function() {
            document.querySelector('.sidebar').classList.toggle('active');
        });
        
        // Animate bars on load
        window.addEventListener('load', function() {
            const bars = document.querySelectorAll('.comparison-bar');
            bars.forEach(bar => {
                const width = bar.style.width;
                bar.style.width = '0';
                setTimeout(() => {
                    bar.style.width = width;
                }, 100);
            });
        });
    </script>
</body>
</html>
