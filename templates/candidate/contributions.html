<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø´Ø§Ø±Ú©Øª Ø´Ù‡Ø±ÙˆÙ†Ø¯ÛŒ - Ù¾Ù†Ù„ Ù†Ù…Ø§ÛŒÙ†Ø¯Ù‡</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/modern-admin.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='fonts/fontawesome/all.min.css') }}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="dashboard-wrapper">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-user-tie" style="font-size: 40px;"></i>
                </div>
                <h2>Ù¾Ù†Ù„ Ù†Ù…Ø§ÛŒÙ†Ø¯Ù‡</h2>
                <p>{{ session.get('candidate_name', 'Ù†Ø§Ù…Ø²Ø¯') }}</p>
            </div>
            
            <nav class="sidebar-menu">
                <a href="{{ url_for('dashboard') }}" class="menu-item">
                    <i class="fas fa-home"></i>
                    <span>Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯</span>
                </a>
                <a href="{{ url_for('contributions') }}" class="menu-item active">
                    <i class="fas fa-users"></i>
                    <span>Ù…Ø´Ø§Ø±Ú©Øª Ø´Ù‡Ø±ÙˆÙ†Ø¯ÛŒ</span>
                </a>
                <a href="{{ url_for('leaderboard') }}" class="menu-item">
                    <i class="fas fa-trophy"></i>
                    <span>Ø¬Ø¯ÙˆÙ„ Ø§Ù…ØªÛŒØ§Ø²Ø§Øª</span>
                </a>
                <a href="{{ url_for('broadcast') }}" class="menu-item">
                    <i class="fas fa-bullhorn"></i>
                    <span>Ù¾ÛŒØ§Ù… Ø§Ù†Ø¨ÙˆÙ‡</span>
                </a>
                <a href="{{ url_for('messages') }}" class="menu-item">
                    <i class="fas fa-envelope"></i>
                    <span>Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§</span>
                </a>
                <a href="{{ url_for('logout') }}" class="menu-item" style="margin-top: auto;">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Ø®Ø±ÙˆØ¬</span>
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="content-header">
                <h1>ğŸ“Š Ù…Ø´Ø§Ø±Ú©Øª Ø´Ù‡Ø±ÙˆÙ†Ø¯ÛŒ</h1>
            </div>

<div class="container-fluid py-4" dir="rtl">
    
    <!-- Ø¢Ù…Ø§Ø± -->
    <div class="row mb-4">
        <div class="col-md-12">
            <h3 class="mb-3">ğŸ“Š Ù…Ø´Ø§Ø±Ú©Øª Ø´Ù‡Ø±ÙˆÙ†Ø¯ÛŒ</h3>
        </div>
        
        <div class="col-md-3 mb-3">
            <div class="card text-center">
                <div class="card-body">
                    <h5 class="card-title text-primary">{{ stats.total }}</h5>
                    <p class="card-text">Ú©Ù„ Ù…Ø´Ø§Ø±Ú©Øªâ€ŒÙ‡Ø§</p>
                </div>
            </div>
        </div>
        
        <div class="col-md-3 mb-3">
            <div class="card text-center">
                <div class="card-body">
                    <h5 class="card-title text-warning">{{ stats.pending }}</h5>
                    <p class="card-text">â³ Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± Ø¨Ø±Ø±Ø³ÛŒ</p>
                </div>
            </div>
        </div>
        
        <div class="col-md-3 mb-3">
            <div class="card text-center">
                <div class="card-body">
                    <h5 class="card-title text-info">{{ stats.in_progress }}</h5>
                    <p class="card-text">ğŸ”„ Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù…</p>
                </div>
            </div>
        </div>
        
        <div class="col-md-3 mb-3">
            <div class="card text-center">
                <div class="card-body">
                    <h5 class="card-title text-success">{{ stats.completed }}</h5>
                    <p class="card-text">âœ… Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯Ù‡</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ÙÛŒÙ„ØªØ±Ù‡Ø§ -->
    <div class="card mb-4">
        <div class="card-body">
            <form method="get" class="row g-3">
                <div class="col-md-3">
                    <label class="form-label">ÙˆØ¶Ø¹ÛŒØª</label>
                    <select name="status" class="form-select" onchange="this.form.submit()">
                        <option value="all" {% if status_filter == 'all' %}selected{% endif %}>Ù‡Ù…Ù‡</option>
                        <option value="pending" {% if status_filter == 'pending' %}selected{% endif %}>â³ Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±</option>
                        <option value="under_review" {% if status_filter == 'under_review' %}selected{% endif %}>ğŸ‘€ Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ</option>
                        <option value="approved" {% if status_filter == 'approved' %}selected{% endif %}>âœ… ØªØ§ÛŒÛŒØ¯ Ø´Ø¯Ù‡</option>
                        <option value="in_progress" {% if status_filter == 'in_progress' %}selected{% endif %}>ğŸ”„ Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù…</option>
                        <option value="completed" {% if status_filter == 'completed' %}selected{% endif %}>âœ”ï¸ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯Ù‡</option>
                        <option value="rejected" {% if status_filter == 'rejected' %}selected{% endif %}>âŒ Ø±Ø¯ Ø´Ø¯Ù‡</option>
                    </select>
                </div>
                
                <div class="col-md-3">
                    <label class="form-label">Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ</label>
                    <select name="category" class="form-select" onchange="this.form.submit()">
                        <option value="all" {% if category_filter == 'all' %}selected{% endif %}>Ù‡Ù…Ù‡</option>
                        {% for cat_value, cat_label in categories %}
                        <option value="{{ cat_value }}" {% if category_filter == cat_value %}selected{% endif %}>{{ cat_label }}</option>
                        {% endfor %}
                    </select>
                </div>
                
                <div class="col-md-3">
                    <label class="form-label">Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ</label>
                    <select name="sort" class="form-select" onchange="this.form.submit()">
                        <option value="newest" {% if sort_by == 'newest' %}selected{% endif %}>Ø¬Ø¯ÛŒØ¯ØªØ±ÛŒÙ†</option>
                        <option value="popular" {% if sort_by == 'popular' %}selected{% endif %}>Ù…Ø­Ø¨ÙˆØ¨â€ŒØªØ±ÛŒÙ†</option>
                        <option value="most_commented" {% if sort_by == 'most_commented' %}selected{% endif %}>Ù¾Ø±Ø¨Ø­Ø«â€ŒØªØ±ÛŒÙ†</option>
                    </select>
                </div>
                
                <div class="col-md-3">
                    <label class="form-label">&nbsp;</label>
                    <a href="{{ url_for('contributions') }}" class="btn btn-secondary w-100">Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ÙÛŒÙ„ØªØ±Ù‡Ø§</a>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Ù„ÛŒØ³Øª Ù…Ø´Ø§Ø±Ú©Øªâ€ŒÙ‡Ø§ -->
    <div class="row">
        {% if contributions %}
            {% for contrib in contributions %}
            <div class="col-md-6 col-lg-4 mb-4">
                <div class="card h-100 shadow-sm hover-shadow">
                    <div class="card-body">
                        <!-- Ù‡Ø¯Ø± -->
                        <div class="d-flex justify-content-between align-items-start mb-3">
                            <div>
                                <span class="badge bg-primary">{{ contrib.tracking_code }}</span>
                                {% if contrib.contribution_type == 'idea' %}
                                <span class="badge bg-info">ğŸ’¡ Ø§ÛŒØ¯Ù‡</span>
                                {% else %}
                                <span class="badge bg-warning">ğŸ“£ Ù…Ø´Ú©Ù„</span>
                                {% endif %}
                            </div>
                            <div>
                                {% if contrib.status == 'pending' %}
                                <span class="badge bg-warning">â³ Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±</span>
                                {% elif contrib.status == 'under_review' %}
                                <span class="badge bg-info">ğŸ‘€ Ø¨Ø±Ø±Ø³ÛŒ</span>
                                {% elif contrib.status == 'approved' %}
                                <span class="badge bg-success">âœ… ØªØ§ÛŒÛŒØ¯</span>
                                {% elif contrib.status == 'in_progress' %}
                                <span class="badge bg-primary">ğŸ”„ Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù…</span>
                                {% elif contrib.status == 'completed' %}
                                <span class="badge bg-success">âœ”ï¸ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯Ù‡</span>
                                {% elif contrib.status == 'rejected' %}
                                <span class="badge bg-danger">âŒ Ø±Ø¯ Ø´Ø¯Ù‡</span>
                                {% endif %}
                            </div>
                        </div>
                        
                        <!-- Ø¹Ù†ÙˆØ§Ù† -->
                        <h5 class="card-title">{{ contrib.title }}</h5>
                        
                        <!-- ØªÙˆØ¶ÛŒØ­Ø§Øª Ú©ÙˆØªØ§Ù‡ -->
                        <p class="card-text text-muted small">
                            {{ contrib.description[:100] }}{% if contrib.description|length > 100 %}...{% endif %}
                        </p>
                        
                        <!-- Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ -->
                        <div class="mb-2">
                            {% if contrib.category == 'education' %}
                            <span class="badge bg-light text-dark">ğŸ“š Ø¢Ù…ÙˆØ²Ø´</span>
                            {% elif contrib.category == 'health' %}
                            <span class="badge bg-light text-dark">ğŸ¥ Ø¨Ù‡Ø¯Ø§Ø´Øª</span>
                            {% elif contrib.category == 'traffic' %}
                            <span class="badge bg-light text-dark">ğŸš— ØªØ±Ø§ÙÛŒÚ©</span>
                            {% elif contrib.category == 'security' %}
                            <span class="badge bg-light text-dark">ğŸ›¡ï¸ Ø§Ù…Ù†ÛŒØª</span>
                            {% elif contrib.category == 'environment' %}
                            <span class="badge bg-light text-dark">ğŸŒ³ Ù…Ø­ÛŒØ· Ø²ÛŒØ³Øª</span>
                            {% elif contrib.category == 'cultural' %}
                            <span class="badge bg-light text-dark">ğŸ­ ÙØ±Ù‡Ù†Ú¯ÛŒ</span>
                            {% elif contrib.category == 'infrastructure' %}
                            <span class="badge bg-light text-dark">ğŸ—ï¸ Ø²ÛŒØ±Ø³Ø§Ø®Øª</span>
                            {% elif contrib.category == 'economic' %}
                            <span class="badge bg-light text-dark">ğŸ’° Ø§Ù‚ØªØµØ§Ø¯</span>
                            {% elif contrib.category == 'welfare' %}
                            <span class="badge bg-light text-dark">ğŸ¤ Ø±ÙØ§Ù‡</span>
                            {% else %}
                            <span class="badge bg-light text-dark">ğŸ“‹ Ø³Ø§ÛŒØ±</span>
                            {% endif %}
                            
                            {% if contrib.priority %}
                                {% if contrib.priority == 'urgent' %}
                                <span class="badge bg-danger">ğŸ”¥ ÙÙˆØ±ÛŒ</span>
                                {% elif contrib.priority == 'high' %}
                                <span class="badge bg-warning">âš ï¸ Ø¨Ø§Ù„Ø§</span>
                                {% elif contrib.priority == 'medium' %}
                                <span class="badge bg-info">â¡ï¸ Ù…ØªÙˆØ³Ø·</span>
                                {% elif contrib.priority == 'low' %}
                                <span class="badge bg-secondary">â¬‡ï¸ Ù¾Ø§ÛŒÛŒÙ†</span>
                                {% endif %}
                            {% endif %}
                        </div>
                        
                        <!-- Ù…ØªØ§ Ø§Ø·Ù„Ø§Ø¹Ø§Øª -->
                        <div class="d-flex justify-content-between align-items-center mt-3 pt-3 border-top">
                            <div class="small text-muted">
                                <span>ğŸ‘¤ {{ contrib.user_first_name }}</span>
                            </div>
                            <div class="small">
                                <span class="me-2">ğŸ‘ {{ contrib.votes_count }}</span>
                                <span class="me-2">ğŸ’¬ {{ contrib.comments_count }}</span>
                                <span>ğŸ‘ï¸ {{ contrib.views_count }}</span>
                            </div>
                        </div>
                        
                        <!-- Ø¯Ú©Ù…Ù‡ Ø¬Ø²Ø¦ÛŒØ§Øª -->
                        <a href="{{ url_for('contribution_detail', contribution_id=contrib.id) }}" class="btn btn-primary w-100 mt-3">
                            Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¬Ø²Ø¦ÛŒØ§Øª
                        </a>
                    </div>
                    
                    <div class="card-footer text-muted small">
                        <span>ğŸ“… {{ contrib.created_at.strftime('%Y/%m/%d %H:%M') }}</span>
                    </div>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="col-12">
                <div class="alert alert-info text-center">
                    <h5>Ù‡Ù†ÙˆØ² Ù…Ø´Ø§Ø±Ú©ØªÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª</h5>
                    <p>Ø´Ù‡Ø±ÙˆÙ†Ø¯Ø§Ù† Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù†Ø¯ Ø§Ø² Ø·Ø±ÛŒÙ‚ Ø±Ø¨Ø§Øª ØªÙ„Ú¯Ø±Ø§Ù… Ø§ÛŒØ¯Ù‡â€ŒÙ‡Ø§ Ùˆ Ù…Ø´Ú©Ù„Ø§Øª Ø®ÙˆØ¯ Ø±Ø§ Ø§Ø±Ø³Ø§Ù„ Ú©Ù†Ù†Ø¯.</p>
                </div>
            </div>
        {% endif %}
    </div>
    
</div>

<style>
.hover-shadow {
    transition: box-shadow 0.3s ease;
}

.hover-shadow:hover {
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15) !important;
}

.card-title {
    font-size: 1.1rem;
    font-weight: bold;
    margin-bottom: 0.75rem;
}
</style>

        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
