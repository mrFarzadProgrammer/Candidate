<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لیست نمایندهها</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/modern-admin.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="dashboard-wrapper">
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo"><i class="fas fa-vote-yea"></i></div>
                <h2>پنل مدیریت</h2>
                <p>سامانه باتهای انتخاباتی</p>
            </div>
            <nav class="sidebar-menu">
                <a href="{{ url_for('dashboard') }}" class="menu-item"><i class="fas fa-chart-line"></i><span>داشبورد</span></a>
                <a href="{{ url_for('candidates') }}" class="menu-item active"><i class="fas fa-users"></i><span>نمایندهها</span></a>
                <a href="{{ url_for('plans') }}" class="menu-item"><i class="fas fa-tags"></i><span>پلنها</span></a>
                <a href="{{ url_for('logout') }}" class="menu-item"><i class="fas fa-sign-out-alt"></i><span>خروج</span></a>
            </nav>
        </aside>
        <main class="main-content">
            <header class="topbar">
                <div class="topbar-left">
                    <button class="sidebar-toggle"><i class="fas fa-bars"></i></button>
                    <h1>لیست نمایندهها</h1>
                </div>
                <div class="topbar-right">
                    <div class="user-profile"><i class="fas fa-user-circle"></i><span>مدیر سیستم</span></div>
                </div>
            </header>
            <div class="content-area">
                <div class="page-header">
                    <h2><i class="fas fa-users"></i> مدیریت نمایندهها</h2>
                    <a href="{{ url_for('create_candidate') }}" class="btn btn-primary"><i class="fas fa-plus"></i> افزودن نماینده</a>
                </div>
                {%if candidates%}
                <div class="table-responsive">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>شناسه</th><th>نام</th><th>کاربری</th><th>تلفن</th><th>پلن</th><th>بات</th><th>عملیات</th>
                            </tr>
                        </thead>
                        <tbody>
                            {%for candidate in candidates%}
                            <tr>
                                <td>{{candidate.id}}</td>
                                <td><div class="user-info"><div class="avatar-gradient">{{candidate.full_name[0]}}</div><span>{{candidate.full_name}}</span></div></td>
                                <td>{{candidate.username}}</td>
                                <td>{{candidate.phone}}</td>
                                <td>{%if candidate.plan%}<span class="badge badge-info">{{candidate.plan.name}}</span>{%else%}<span class="badge badge-secondary">بدون پلن</span>{%endif%}</td>
                                <td>{%if candidate.bot_token%}<span class="badge badge-success"><i class="fas fa-check-circle"></i> فعال</span>{%else%}<span class="badge badge-warning"><i class="fas fa-times-circle"></i> غیرفعال</span>{%endif%}</td>
                                <td><div class="action-buttons"><a href="{{url_for('setup_bot',candidate_id=candidate.id)}}" class="btn btn-sm btn-info"><i class="fas fa-robot"></i></a><a href="#" class="btn btn-sm btn-success"><i class="fas fa-edit"></i></a><a href="#" class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></a></div></td>
                            </tr>
                            {%endfor%}
                        </tbody>
                    </table>
                </div>
                {%else%}
                <div class="empty-state">
                    <div class="empty-icon"><i class="fas fa-users-slash"></i></div>
                    <h3>هیچ نمایندهای ثبت نشده</h3>
                    <p>برای شروع اولین نماینده خود را اضافه کنید</p>
                    <a href="{{ url_for('create_candidate') }}" class="btn btn-primary"><i class="fas fa-plus"></i> افزودن نماینده</a>
                </div>
                {%endif%}
            </div>
        </main>
    </div>
    <script>
        document.querySelector('.sidebar-toggle').addEventListener('click', function() {
            document.querySelector('.sidebar').classList.toggle('active');
        });
    </script>
</body>
</html>